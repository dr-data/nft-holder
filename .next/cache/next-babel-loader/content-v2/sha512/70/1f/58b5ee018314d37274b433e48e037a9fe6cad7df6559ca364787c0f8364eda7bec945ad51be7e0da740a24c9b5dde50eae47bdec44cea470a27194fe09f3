{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/joker/Desktop/ink/work/nft-holder/pages/search.tsx\";\nimport { useRouter } from 'next/router';\nimport { useState } from 'react';\nimport { Input, Modal, Typography, Select, Row, Col, Button, Carousel, Image } from 'antd';\nimport { QuestionCircleFilled, CloseCircleOutlined } from '@ant-design/icons';\nimport WeiboUtil from 'weibo-util';\nimport IconFont from '../components/iconfont';\nimport Layout from '../components/layout';\nimport FeaturedFlow from '../components/featured-flow';\nimport useIsMobile from '../hooks/use-is-mobile';\nimport fetchRecommendCards from '../lib/fetch-recommend-cards';\nimport styles from '../styles/search.module.css';\nexport default function Search({\n  list\n}) {\n  const router = useRouter();\n  const isMobile = useIsMobile();\n  const {\n    0: questionVisible,\n    1: setQuestionVisible\n  } = useState(false);\n  const {\n    0: searching,\n    1: setSearching\n  } = useState(false);\n  const {\n    0: searchType,\n    1: setSearchType\n  } = useState('weibo');\n  const {\n    0: searchValue,\n    1: setSearchValue\n  } = useState('');\n\n  const onSearch = () => {\n    setSearching(true);\n\n    switch (searchType) {\n      case 'weibo':\n        {\n          let id;\n\n          if (searchValue.includes('m.weibo')) {\n            id = searchValue.substr(-16, 16);\n          } else {\n            const {\n              error,\n              mid,\n              uid\n            } = WeiboUtil.getMidUid(searchValue);\n\n            if (error || mid.length !== 16 || uid.length !== 10) {\n              Modal.warn({\n                title: '提示',\n                content: /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [\"\\u8BF7\\u8F93\\u5165\\u6B63\\u786E\\u7684\\u5FAE\\u535AURL\\uFF0C\\u4F8B\\u5982\\uFF1A\", /*#__PURE__*/_jsxDEV(Typography.Link, {\n                    href: \"https://weibo.com/6541507761/JmxU17Osp\",\n                    copyable: {\n                      tooltips: ['复制链接', '复制成功']\n                    },\n                    children: \"https://weibo.com/6541507761/JmxU17Osp\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 55,\n                    columnNumber: 19\n                  }, this)]\n                }, void 0, true)\n              });\n              setSearching(false);\n              return;\n            }\n\n            id = mid;\n          }\n\n          router.push(`/detail/${id}`);\n          break;\n        }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles['search-wrapper'],\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.search,\n          children: [/*#__PURE__*/_jsxDEV(Row, {\n            gutter: 6,\n            children: [/*#__PURE__*/_jsxDEV(Col, {\n              xs: 20,\n              sm: 19,\n              children: /*#__PURE__*/_jsxDEV(Input.Group, {\n                compact: true,\n                size: \"large\",\n                children: [/*#__PURE__*/_jsxDEV(Select, {\n                  showArrow: true,\n                  defaultValue: \"weibo\",\n                  style: {\n                    width: !isMobile ? '17%' : '30%'\n                  },\n                  className: styles['search-type'],\n                  dropdownClassName: styles['search-type-dropdown'],\n                  onChange: value => setSearchType(value),\n                  children: /*#__PURE__*/_jsxDEV(Select.Option, {\n                    value: \"weibo\",\n                    children: \"\\u5FAE\\u535A\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 91,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 83,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Input, {\n                  style: {\n                    width: !isMobile ? '83%' : '70%'\n                  },\n                  className: styles['search-input'],\n                  placeholder: \"\\u8BF7\\u8F93\\u5165\\u5FAE\\u535A\\u5730\\u5740\",\n                  onChange: e => setSearchValue(e.target.value),\n                  onPressEnter: () => onSearch()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 93,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 82,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              xs: 4,\n              sm: 5,\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                block: true,\n                type: \"primary\",\n                size: \"large\",\n                icon: /*#__PURE__*/_jsxDEV(IconFont, {\n                  type: \"iconsearch\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 107,\n                  columnNumber: 25\n                }, this),\n                onClick: onSearch,\n                loading: searching,\n                style: {\n                  width: isMobile ? '100%' : undefined\n                },\n                children: !isMobile && '搜索'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 103,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.question,\n            onClick: () => setQuestionVisible(true),\n            children: [/*#__PURE__*/_jsxDEV(QuestionCircleFilled, {\n              className: styles.icon\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: styles.text,\n              children: \"\\u5982\\u4F55\\u83B7\\u53D6\\u5FAE\\u535A\\u94FE\\u63A5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(FeaturedFlow, {\n        list: list\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      width: isMobile ? undefined : 646,\n      centered: !!isMobile,\n      className: \"learn-modal\",\n      closeIcon: /*#__PURE__*/_jsxDEV(CloseCircleOutlined, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 20\n      }, this),\n      maskClosable: false,\n      footer: false,\n      visible: questionVisible,\n      onCancel: () => setQuestionVisible(false),\n      bodyStyle: {\n        padding: 0,\n        backgroundColor: 'transparent'\n      },\n      children: /*#__PURE__*/_jsxDEV(Carousel, {\n        arrows: true,\n        infinite: false,\n        prevArrow: /*#__PURE__*/_jsxDEV(\"span\", {\n          children: !isMobile ? '上一步' : ''\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 22\n        }, this),\n        nextArrow: /*#__PURE__*/_jsxDEV(\"span\", {\n          children: !isMobile ? '下一步' : ''\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 22\n        }, this),\n        className: styles.side,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.photo,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.title,\n            children: \"Step 1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Image, {\n            preview: false,\n            src: \"/learn01.png\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.photo,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.title,\n            children: \"Step 2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Image, {\n            preview: false,\n            src: \"/learn02.png\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 5\n  }, this);\n}\nexport const getServerSideProps = async () => {\n  try {\n    const result = await fetchRecommendCards(15, 1);\n    const {\n      list\n    } = result;\n    return {\n      props: {\n        list: list ? [...list.map(item => {\n          const data = {\n            id: item.data.data.id,\n            creator: {\n              id: item.data.data.user.id.toString(),\n              avatar: item.data.data.user.profile_image_url,\n              name: item.data.data.user.screen_name\n            },\n            content: item.data.data.text,\n            thumbnails: item.data.data.pics ? item.data.data.pics.map(item => item.url) : [],\n            repostsCount: item.data.data.reposts_count,\n            commentsCount: item.data.data.comments_count,\n            attitudesCount: item.data.data.attitudes_count\n          };\n\n          if (item.owner_id !== item.uid) {\n            data.holder = {\n              id: item.owner_id,\n              name: item.owner_name\n            };\n          }\n\n          if (item.amount) {\n            data.quotedPrice = {\n              top: item.amount * 1\n            };\n          }\n\n          return data;\n        })] : []\n      }\n    };\n  } catch (error) {\n    console.error(error);\n    return {\n      props: {\n        list: []\n      }\n    };\n  }\n};","map":{"version":3,"sources":["/Users/joker/Desktop/ink/work/nft-holder/pages/search.tsx"],"names":["useRouter","useState","Input","Modal","Typography","Select","Row","Col","Button","Carousel","Image","QuestionCircleFilled","CloseCircleOutlined","WeiboUtil","IconFont","Layout","FeaturedFlow","useIsMobile","fetchRecommendCards","styles","Search","list","router","isMobile","questionVisible","setQuestionVisible","searching","setSearching","searchType","setSearchType","searchValue","setSearchValue","onSearch","id","includes","substr","error","mid","uid","getMidUid","length","warn","title","content","tooltips","push","search","width","value","e","target","undefined","question","icon","text","padding","backgroundColor","side","photo","getServerSideProps","result","props","map","item","data","creator","user","toString","avatar","profile_image_url","name","screen_name","thumbnails","pics","url","repostsCount","reposts_count","commentsCount","comments_count","attitudesCount","attitudes_count","owner_id","holder","owner_name","amount","quotedPrice","top","console"],"mappings":"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","sourcesContent":["import { GetServerSideProps } from 'next'\nimport { useRouter } from 'next/router'\nimport { useState } from 'react'\nimport {\n  Input,\n  Modal,\n  Typography,\n  Select,\n  Row,\n  Col,\n  Button,\n  Carousel,\n  Image\n} from 'antd'\nimport { QuestionCircleFilled, CloseCircleOutlined } from '@ant-design/icons'\nimport WeiboUtil from 'weibo-util'\n\nimport IconFont from '../components/iconfont'\nimport Layout from '../components/layout'\nimport FeaturedFlow from '../components/featured-flow'\nimport useIsMobile from '../hooks/use-is-mobile'\nimport fetchRecommendCards from '../lib/fetch-recommend-cards'\nimport { CardDataType } from '../typings/card'\nimport styles from '../styles/search.module.css'\n\nexport interface SearchProps {\n  list: CardDataType[]\n}\n\nexport type SearchType = 'weibo'\n\nexport default function Search({ list }: SearchProps) {\n  const router = useRouter()\n  const isMobile = useIsMobile()\n  const [questionVisible, setQuestionVisible] = useState<boolean>(false)\n  const [searching, setSearching] = useState<boolean>(false)\n  const [searchType, setSearchType] = useState<SearchType>('weibo')\n  const [searchValue, setSearchValue] = useState<string>('')\n\n  const onSearch = () => {\n    setSearching(true)\n    switch (searchType) {\n      case 'weibo': {\n        let id\n        if (searchValue.includes('m.weibo')) {\n          id = searchValue.substr(-16, 16)\n        } else {\n          const { error, mid, uid } = WeiboUtil.getMidUid(searchValue)\n          if (error || mid.length !== 16 || uid.length !== 10) {\n            Modal.warn({\n              title: '提示',\n              content: (\n                <>\n                  请输入正确的微博URL，例如：\n                  <Typography.Link\n                    href=\"https://weibo.com/6541507761/JmxU17Osp\"\n                    copyable={{ tooltips: ['复制链接', '复制成功'] }}\n                  >\n                    https://weibo.com/6541507761/JmxU17Osp\n                  </Typography.Link>\n                </>\n              )\n            })\n            setSearching(false)\n            return\n          }\n          id = mid\n        }\n        router.push(`/detail/${id}`)\n        break\n      }\n    }\n  }\n\n  return (\n    <Layout>\n      <div className=\"container\">\n        <div className={styles['search-wrapper']}>\n          <div className={styles.search}>\n            <Row gutter={6}>\n              <Col xs={20} sm={19}>\n                <Input.Group compact size=\"large\">\n                  <Select\n                    showArrow\n                    defaultValue=\"weibo\"\n                    style={{ width: !isMobile ? '17%' : '30%' }}\n                    className={styles['search-type']}\n                    dropdownClassName={styles['search-type-dropdown']}\n                    onChange={(value) => setSearchType(value)}\n                  >\n                    <Select.Option value=\"weibo\">微博</Select.Option>\n                  </Select>\n                  <Input\n                    style={{ width: !isMobile ? '83%' : '70%' }}\n                    className={styles['search-input']}\n                    placeholder=\"请输入微博地址\"\n                    onChange={(e) => setSearchValue(e.target.value)}\n                    onPressEnter={() => onSearch()}\n                  />\n                </Input.Group>\n              </Col>\n              <Col xs={4} sm={5}>\n                <Button\n                  block\n                  type=\"primary\"\n                  size=\"large\"\n                  icon={<IconFont type=\"iconsearch\" />}\n                  onClick={onSearch}\n                  loading={searching}\n                  style={{ width: isMobile ? '100%' : undefined }}\n                >\n                  {!isMobile && '搜索'}\n                </Button>\n              </Col>\n            </Row>\n            <div\n              className={styles.question}\n              onClick={() => setQuestionVisible(true)}\n            >\n              <QuestionCircleFilled className={styles.icon} />\n              <span className={styles.text}>如何获取微博链接</span>\n            </div>\n          </div>\n        </div>\n        <FeaturedFlow list={list} />\n      </div>\n\n      <Modal\n        width={isMobile ? undefined : 646}\n        centered={!!isMobile}\n        className=\"learn-modal\"\n        closeIcon={<CloseCircleOutlined />}\n        maskClosable={false}\n        footer={false}\n        visible={questionVisible}\n        onCancel={() => setQuestionVisible(false)}\n        bodyStyle={{ padding: 0, backgroundColor: 'transparent' }}\n      >\n        <Carousel\n          arrows\n          infinite={false}\n          prevArrow={<span>{!isMobile ? '上一步' : ''}</span>}\n          nextArrow={<span>{!isMobile ? '下一步' : ''}</span>}\n          className={styles.side}\n        >\n          <div className={styles.photo}>\n            <div className={styles.title}>Step 1</div>\n            <Image preview={false} src=\"/learn01.png\" />\n          </div>\n          <div className={styles.photo}>\n            <div className={styles.title}>Step 2</div>\n            <Image preview={false} src=\"/learn02.png\" />\n          </div>\n        </Carousel>\n      </Modal>\n    </Layout>\n  )\n}\n\nexport const getServerSideProps: GetServerSideProps<{\n  list: CardDataType[]\n}> = async () => {\n  try {\n    const result = await fetchRecommendCards(15, 1)\n    const { list } = result\n\n    return {\n      props: {\n        list: list\n          ? [\n              ...list.map((item: any) => {\n                const data: CardDataType = {\n                  id: item.data.data.id,\n                  creator: {\n                    id: item.data.data.user.id.toString(),\n                    avatar: item.data.data.user.profile_image_url,\n                    name: item.data.data.user.screen_name\n                  },\n                  content: item.data.data.text,\n                  thumbnails: item.data.data.pics\n                    ? item.data.data.pics.map((item: any) => item.url)\n                    : [],\n                  repostsCount: item.data.data.reposts_count,\n                  commentsCount: item.data.data.comments_count,\n                  attitudesCount: item.data.data.attitudes_count\n                }\n\n                if (item.owner_id !== item.uid) {\n                  data.holder = {\n                    id: item.owner_id,\n                    name: item.owner_name\n                  }\n                }\n\n                if (item.amount) {\n                  data.quotedPrice = {\n                    top: item.amount * 1\n                  }\n                }\n\n                return data\n              })\n            ]\n          : []\n      }\n    }\n  } catch (error) {\n    console.error(error)\n    return { props: { list: [] } }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}